"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1482],{3729:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"Smart/Intro","title":"SMART Overview","description":"SMART on FHIR is an open standard for launching healthcare apps securely against FHIR APIs. It defines how apps obtain authorization (scopes) and user context (patient, practitioner) using OAuth 2.0 and OpenID Connect.","source":"@site/docs/Smart/Intro.mdx","sourceDirName":"Smart","slug":"/Smart/Intro","permalink":"/docs/Smart/Intro","draft":false,"unlisted":false,"editUrl":"https://github.com/couchbaselabs/couchbase-fhir-ce-docs/tree/master/docs/Smart/Intro.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"SMART Overview"},"sidebar":"tutorialSidebar","previous":{"title":"Vanya Client","permalink":"/docs/API Clients/Vanya"},"next":{"title":"Client Registration","permalink":"/docs/Smart/Client-Registration"}}');var s=t(4848),r=t(8453);const o={sidebar_position:1,title:"SMART Overview"},a="SMART on FHIR Overview",c={},l=[{value:"Why SMART?",id:"why-smart",level:2},{value:"OAuth 2 Flow",id:"oauth-2-flow",level:2},{value:"Launch Types",id:"launch-types",level:2},{value:"Scopes",id:"scopes",level:2},{value:"PKCE",id:"pkce",level:2},{value:"Clients",id:"clients",level:2},{value:"How It Works in Couchbase FHIR CE",id:"how-it-works-in-couchbase-fhir-ce",level:2},{value:"Related Pages",id:"related-pages",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"smart-on-fhir-overview",children:"SMART on FHIR Overview"})}),"\n",(0,s.jsx)(n.p,{children:"SMART on FHIR is an open standard for launching healthcare apps securely against FHIR APIs. It defines how apps obtain authorization (scopes) and user context (patient, practitioner) using OAuth 2.0 and OpenID Connect."}),"\n",(0,s.jsx)(n.h2,{id:"why-smart",children:"Why SMART?"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Standardized app launch flows that work across EHRs and FHIR servers"}),"\n",(0,s.jsxs)(n.li,{children:["Fine-grained permission model using SMART scopes (e.g., ",(0,s.jsx)(n.code,{children:"patient/Observation.rs"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["User identity and context via OpenID Connect (",(0,s.jsx)(n.code,{children:"openid"}),", ",(0,s.jsx)(n.code,{children:"fhirUser"}),", ",(0,s.jsx)(n.code,{children:"launch/patient"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Security best practices: PKCE, confidential/public clients, redirect URIs"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"oauth-2-flow",children:"OAuth 2 Flow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Client    \u2502\n\u2502 Application \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u2502 1. GET /oauth2/authorize?client_id=X&state=ABC&redirect_uri=...\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Spring Authorization Server        \u2502\n\u2502  (Our FHIR Server)                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u2502 2. Check: Is user authenticated?\n       \u2502    NO \u2192 Redirect to /oauth2/login\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Login Page  \u2502 User enters credentials\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502 3. POST credentials\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Spring Security Authentication     \u2502\n\u2502  - Validates credentials            \u2502\n\u2502  - Creates Authentication object    \u2502\n\u2502  - Calls SmartOAuthSuccessHandler   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u2502 4. SmartOAuthSuccessHandler:\n       \u2502    - Gets SavedRequest (original /oauth2/authorize URL)\n       \u2502    - If practitioner + launch/patient \u2192 /patient-picker\n       \u2502    - Otherwise \u2192 Redirect to savedUrl (back to /oauth2/authorize)\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Spring Authorization Server        \u2502\n\u2502  Processes /oauth2/authorize again  \u2502\n\u2502                                     \u2502\n\u2502  5. Check: Is user authenticated?   \u2502\n\u2502     YES \u2713                           \u2502\n\u2502                                     \u2502\n\u2502  6. Check: Does client require      \u2502\n\u2502     consent?                        \u2502\n\u2502     YES \u2192 Need consent              \u2502\n\u2502                                     \u2502\n\u2502  7. Create OAuth2Authorization with:\u2502\n\u2502     - id: random UUID               \u2502\n\u2502     - state: (consent state)        \u2502\n\u2502     - Store in OAuth2Authorization  \u2502\n\u2502       ConsentService                \u2502\n\u2502                                     \u2502\n\u2502  8. Redirect to /consent with       \u2502\n\u2502     state parameter                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Consent     \u2502 User sees scopes,\n\u2502 Page        \u2502 clicks "Approve"\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u2502 9. POST /oauth2/authorize with:\n       \u2502    - client_id=X\n       \u2502    - state=ABC (from hidden field)\n       \u2502    - consent_action=approve\n       \u2502    - scope=...\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Spring Authorization Server        \u2502\n\u2502  Processes consent POST             \u2502\n\u2502                                     \u2502\n\u2502  10. Recognize this as consent      \u2502\n\u2502      approval (has consent_action)  \u2502\n\u2502                                     \u2502\n\u2502  11. Look up OAuth2Authorization    \u2502\n\u2502      by state from step 7           \u2502\n\u2502      MATCH FOUND \u2713                  \u2502\n\u2502                                     \u2502\n\u2502  12. Mark consent as approved       \u2502\n\u2502                                     \u2502\n\u2502  13. Generate authorization code    \u2502\n\u2502                                     \u2502\n\u2502  14. Redirect to client:            \u2502\n\u2502      redirect_uri?code=XYZ&state=ABC\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Client    \u2502 Receives authorization\n\u2502 Application \u2502 code, exchanges for token\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n'})}),"\n",(0,s.jsx)(n.h2,{id:"launch-types",children:"Launch Types"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Patient Standalone: App is launched directly by a patient; scope requests are limited to the patient\u2019s data"}),"\n",(0,s.jsx)(n.li,{children:"Provider Standalone: App is launched by a clinician; scope requests may include broader access (e.g., all patients)"}),"\n",(0,s.jsx)(n.li,{children:"EHR Launch (coming soon): App launches within an EHR with additional context (e.g., current patient)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"scopes",children:"Scopes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Required baseline scopes: ",(0,s.jsx)(n.code,{children:"launch/patient"}),", ",(0,s.jsx)(n.code,{children:"openid"}),", ",(0,s.jsx)(n.code,{children:"fhirUser"}),", ",(0,s.jsx)(n.code,{children:"offline_access"})]}),"\n",(0,s.jsxs)(n.li,{children:["Resource-level read scopes: ",(0,s.jsx)(n.code,{children:"patient/<Resource>.rs"})," (e.g., ",(0,s.jsx)(n.code,{children:"patient/Observation.rs"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["\u201cAll Read\u201d convenience: ",(0,s.jsx)(n.code,{children:"patient/*.rs"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Scopes define what the app can read/write and whether access is constrained to a single patient."}),"\n",(0,s.jsx)(n.h2,{id:"pkce",children:"PKCE"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PKCE (Proof Key for Code Exchange) protects public apps (mobile/web) from authorization code interception"}),"\n",(0,s.jsxs)(n.li,{children:["Recommended to keep PKCE enabled with ",(0,s.jsx)(n.code,{children:"SHA-256"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"clients",children:"Clients"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Public clients: no client secret (browser/mobile)"}),"\n",(0,s.jsx)(n.li,{children:"Confidential clients: client secret required (server-side apps)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Client type influences how tokens are issued and where secrets are stored."}),"\n",(0,s.jsx)(n.h2,{id:"how-it-works-in-couchbase-fhir-ce",children:"How It Works in Couchbase FHIR CE"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Built-in Spring Authorization Server provides OAuth/OpenID endpoints"}),"\n",(0,s.jsx)(n.li,{children:"Admin UI includes Client Registration, Patient/Provider Standalone flows, and consent screens"}),"\n",(0,s.jsx)(n.li,{children:"Registered clients request SMART scopes; users grant consent; tokens carry scopes and user context"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"related-pages",children:"Related Pages"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Client Registration: ",(0,s.jsx)(n.a,{href:"/docs/Smart/Client-Registration",children:"docs/Smart/Client-Registration.mdx"})]}),"\n",(0,s.jsxs)(n.li,{children:["Inferno SMART Client: ",(0,s.jsx)(n.a,{href:"/docs/Smart/Inferno",children:"docs/Smart/Inferno.mdx"})]}),"\n",(0,s.jsxs)(n.li,{children:["OAuth Overview: ",(0,s.jsx)(n.a,{href:"/docs/API%20Tokens/OAuth",children:"docs/API Tokens/OAuth.mdx"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);