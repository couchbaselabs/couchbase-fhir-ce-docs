"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8536],{2118:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"Install Couchbase FHIR Server/Validation","title":"Validation and Profile","description":"When converting a Couchbase bucket into a FHIR-compliant store, validation ensures that all resources conform to the FHIR specification and optional implementation guides such as US Core.","source":"@site/docs/Install Couchbase FHIR Server/Validation.md","sourceDirName":"Install Couchbase FHIR Server","slug":"/Install Couchbase FHIR Server/Validation","permalink":"/docs/Install Couchbase FHIR Server/Validation","draft":false,"unlisted":false,"editUrl":"https://github.com/couchbaselabs/couchbase-fhir-ce-docs/tree/master/docs/Install Couchbase FHIR Server/Validation.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Validation and Profile","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Create config.yaml","permalink":"/docs/Install Couchbase FHIR Server/Create Config.yaml"},"next":{"title":"Install FHIR Server","permalink":"/docs/Install Couchbase FHIR Server/Install FHIR Server"}}');var l=i(4848),r=i(8453);const d={title:"Validation and Profile",sidebar_position:2},t="Validation and Profiles",a={},o=[{value:"Validation Mode",id:"validation-mode",level:3},{value:"Lenient",id:"lenient",level:4},{value:"None (Disabled)",id:"none-disabled",level:4},{value:"Validation Profiles",id:"validation-profiles",level:3},{value:"None",id:"none",level:4},{value:"US Core 6.1.0",id:"us-core-610",level:4},{value:"Example Scenarios",id:"example-scenarios",level:3},{value:"Modes at a Glance",id:"modes-at-a-glance",level:2},{value:"FHIR Normalization (applies to all modes)",id:"fhir-normalization-applies-to-all-modes",level:2},{value:"Validation Examples",id:"validation-examples",level:2},{value:"\u2705 Valid in all modes",id:"-valid-in-all-modes",level:4},{value:"\u26a0 Passes lenient / fails none only if external checks are present",id:"-passes-lenient--fails-none-only-if-external-checks-are-present",level:4},{value:"\u274c Fails lenient",id:"-fails-lenient",level:4},{value:"\u274c Fails lenient",id:"-fails-lenient-1",level:4},{value:"\u274c Fails lenient",id:"-fails-lenient-2",level:4},{value:"Notes",id:"notes",level:2},{value:"When Profiles Are Enabled",id:"when-profiles-are-enabled",level:2},{value:"Recommended Modes",id:"recommended-modes",level:2},{value:"Understanding \u201cHelpful\u201d Parsing",id:"understanding-helpful-parsing",level:2},{value:"Summary",id:"summary",level:2},{value:"Bottom line:",id:"bottom-line",level:3}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"validation-and-profiles",children:"Validation and Profiles"})}),"\n",(0,l.jsx)(n.p,{children:"When converting a Couchbase bucket into a FHIR-compliant store, validation ensures that all resources conform to the FHIR specification and optional implementation guides such as US Core.\nCouchbase FHIR CE allows you to control the depth and strictness of validation based on your environment and data quality."}),"\n",(0,l.jsx)(n.h3,{id:"validation-mode",children:"Validation Mode"}),"\n",(0,l.jsxs)(n.p,{children:["Defines how incoming FHIR resources are validated. Modes align with ",(0,l.jsx)(n.code,{children:"config.yaml"}),":"]}),"\n",(0,l.jsx)(n.h4,{id:"lenient",children:"Lenient"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Runs FHIR validation and logs warnings instead of rejecting errors."}),"\n",(0,l.jsx)(n.li,{children:"Accepts resources even if some fields fail validation."}),"\n",(0,l.jsx)(n.li,{children:"Good for development, integration testing, or mixed-quality sources."}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"none-disabled",children:"None (Disabled)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Skips validation for maximum performance."}),"\n",(0,l.jsx)(n.li,{children:"Recommended only for trusted pipelines or when validation is handled externally."}),"\n",(0,l.jsx)(n.li,{children:"Useful for bulk imports or synthetic data loading."}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{type:"tip",children:(0,l.jsxs)(n.p,{children:["Validation adds CPU overhead \u2014 use ",(0,l.jsx)(n.code,{children:"lenient"})," or ",(0,l.jsx)(n.code,{children:"none"})," for bulk operations depending on data quality."]})}),"\n",(0,l.jsx)(n.h3,{id:"validation-profiles",children:"Validation Profiles"}),"\n",(0,l.jsx)(n.p,{children:"Controls which FHIR Implementation Guide (IG) is used to validate resource structure and values."}),"\n",(0,l.jsx)(n.h4,{id:"none",children:"None"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Performs base FHIR R4 validation only."}),"\n",(0,l.jsxs)(n.li,{children:["Checks standard FHIR structural rules:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Field types"}),"\n",(0,l.jsx)(n.li,{children:"Required elements"}),"\n",(0,l.jsx)(n.li,{children:"Enumerations and primitive constraints"}),"\n",(0,l.jsx)(n.li,{children:"Does not enforce US Core or regional extensions."}),"\n",(0,l.jsx)(n.li,{children:"Suitable for generic FHIR projects or non-US implementations."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"us-core-610",children:"US Core 6.1.0"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Enforces the HL7\xae US Core Implementation Guide 6.1.0, including:"}),"\n",(0,l.jsx)(n.li,{children:"Mandatory profiles for key resources (Patient, Observation, Condition, etc.)"}),"\n",(0,l.jsx)(n.li,{children:"Required extensions and bindings"}),"\n",(0,l.jsx)(n.li,{children:"ValueSet constraints (e.g., specific coding systems, LOINC, SNOMED)"}),"\n",(0,l.jsx)(n.li,{children:"Validates both structure and terminology bindings (e.g., codes must belong to specific value sets)."}),"\n",(0,l.jsx)(n.li,{children:"Ensures compatibility with US Core tests such as HL7 Inferno."}),"\n",(0,l.jsx)(n.li,{children:"Uses HAPI FHIR validator and NPM IG packages under the hood."}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"example-scenarios",children:"Example Scenarios"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Environment"}),(0,l.jsx)(n.th,{children:"Validation Mode"}),(0,l.jsx)(n.th,{children:"Profile"}),(0,l.jsx)(n.th,{children:"Reason"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Development"}),(0,l.jsx)(n.td,{children:"Lenient"}),(0,l.jsx)(n.td,{children:"None"}),(0,l.jsx)(n.td,{children:"Flexibility to test payloads and iteratively fix issues"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Bulk Import / Synthetic Data"}),(0,l.jsx)(n.td,{children:"None"}),(0,l.jsx)(n.td,{children:"None"}),(0,l.jsx)(n.td,{children:"Max speed, external validation assumed"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"US projects (profiles on)"}),(0,l.jsx)(n.td,{children:"Lenient"}),(0,l.jsx)(n.td,{children:"US Core 6.1.0"}),(0,l.jsx)(n.td,{children:"See warnings, keep data flowing"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"modes-at-a-glance",children:"Modes at a Glance"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Mode"}),(0,l.jsx)(n.th,{children:"Behavior"}),(0,l.jsx)(n.th,{children:"Typical Use"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"none"})}),(0,l.jsxs)(n.td,{children:["No validation performed; accepts any JSON containing ",(0,l.jsx)(n.code,{children:"resourceType"}),"."]}),(0,l.jsx)(n.td,{children:"Rapid development, bulk import, trusted data sources"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"lenient"})}),(0,l.jsx)(n.td,{children:"Validates against FHIR R4; logs warnings instead of rejecting on errors."}),(0,l.jsx)(n.td,{children:"Integration with legacy systems, relaxed QA"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"fhir-normalization-applies-to-all-modes",children:"FHIR Normalization (applies to all modes)"}),"\n",(0,l.jsx)(n.p,{children:"Couchbase FHIR always normalizes input before validation:"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Input"}),(0,l.jsx)(n.th,{children:"Normalized Output"}),(0,l.jsx)(n.th,{children:"Note"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'"given": "John"'})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'"given": ["John"]'})}),(0,l.jsx)(n.td,{children:"Single \u2192 array"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'"active": [true]'})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'"active": true'})}),(0,l.jsx)(n.td,{children:"Array \u2192 scalar"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'"family": " Smith "'})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'"family": "Smith"'})}),(0,l.jsx)(n.td,{children:"Trims whitespace"})]})]})]}),"\n",(0,l.jsx)(n.admonition,{type:"warning",children:(0,l.jsx)(n.p,{children:"Because normalization happens first, even strict mode won\u2019t flag these shorthand formats as errors. Validation occurs after parsing."})}),"\n",(0,l.jsx)(n.h2,{id:"validation-examples",children:"Validation Examples"}),"\n",(0,l.jsx)(n.h4,{id:"-valid-in-all-modes",children:"\u2705 Valid in all modes"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'{ "resourceType": "Patient",\n  "name": [{ "use": "official", "family": "Smith", "given": ["John"] }],\n  "gender": "male",\n  "birthDate": "1990-01-01"\n}\n'})}),"\n",(0,l.jsx)(n.h4,{id:"-passes-lenient--fails-none-only-if-external-checks-are-present",children:"\u26a0 Passes lenient / fails none only if external checks are present"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'{ "resourceType": "Patient",\n  "name": [{ "family": "Smith" }],\n  "gender": "male"\n}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Reason: With US Core profile enabled, identifier and full name are expected.","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"none \u2192 \u2705 accepts"}),"\n",(0,l.jsx)(n.li,{children:"lenient \u2192 \u26a0 warns, still stores"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"-fails-lenient",children:"\u274c Fails lenient"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'{ "resourceType": "Patient",\n  "gender": "attack-helicopter",\n  "birthDate": "1990-01-01" }\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Invalid enum (gender must be male | female | other | unknown)."}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"-fails-lenient-1",children:"\u274c Fails lenient"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'{ "resourceType": "Patient",\n  "gender": "Male",\n  "birthDate": "01/01/1990" }\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Wrong case + date format (YYYY-MM-DD expected)."}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"-fails-lenient-2",children:"\u274c Fails lenient"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'{ "resourceType": "Patient",\n  "name": "Smith",\n  "gender": "male" }\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"name must be an array; invalid cardinality."}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["For base FHIR R4 (no profiles), both modes accept compatible resources; ",(0,l.jsx)(n.code,{children:"lenient"})," still warns on minor issues."]}),"\n",(0,l.jsxs)(n.li,{children:["When profiles or terminology validation are active, ",(0,l.jsx)(n.code,{children:"lenient"})," logs warnings for violations while ",(0,l.jsx)(n.code,{children:"none"})," bypasses validation entirely."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"when-profiles-are-enabled",children:"When Profiles Are Enabled"}),"\n",(0,l.jsx)(n.p,{children:"With a profile such as US Core 6.1.0, validation extends beyond base FHIR and checks required fields and terminology bindings. Example requirements for Patient include an identifier and a full name."}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Mode"}),(0,l.jsx)(n.th,{children:"Result"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"none"}),(0,l.jsx)(n.td,{children:"\u2705 Accepted"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"lenient"}),(0,l.jsx)(n.td,{children:"\u26a0 Logs warnings, stores anyway"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"recommended-modes",children:"Recommended Modes"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Use Case"}),(0,l.jsx)(n.th,{children:"Recommended Mode"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Development / testing"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.strong,{children:"none"})," \u2014 fastest, skip validation"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Integration / external sources"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.strong,{children:"lenient"})," \u2014 allow warnings, keep data flowing"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Internal tools / synthetic data"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.strong,{children:"lenient"})," \u2014 balance speed and safety"]})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"understanding-helpful-parsing",children:"Understanding \u201cHelpful\u201d Parsing"}),"\n",(0,l.jsx)(n.p,{children:"Couchbase FHIR intentionally makes parsing forgiving to simplify developer experience:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Converts single values to arrays automatically."}),"\n",(0,l.jsx)(n.li,{children:"Trims whitespace."}),"\n",(0,l.jsx)(n.li,{children:"Normalizes data types where unambiguous."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"This means lenient and strict share the same parser \u2014 strict mode focuses on semantic validation, not raw JSON schema enforcement."}),"\n",(0,l.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Mode"}),(0,l.jsx)(n.th,{children:"Checks"}),(0,l.jsx)(n.th,{children:"Rejects"}),(0,l.jsx)(n.th,{children:"Best For"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"none"}),(0,l.jsx)(n.td,{children:"None"}),(0,l.jsx)(n.td,{children:"Nothing"}),(0,l.jsx)(n.td,{children:"Bulk load, dev"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"lenient"}),(0,l.jsx)(n.td,{children:"FHIR rules (+ warnings)"}),(0,l.jsx)(n.td,{children:"Severe structural errors"}),(0,l.jsx)(n.td,{children:"Integration"})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"bottom-line",children:"Bottom line:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Without profiles, both modes accept compatible resources; ",(0,l.jsx)(n.code,{children:"lenient"})," provides warnings."]}),"\n",(0,l.jsxs)(n.li,{children:["With profiles, ",(0,l.jsx)(n.code,{children:"lenient"})," warns on violations; ",(0,l.jsx)(n.code,{children:"none"})," skips validation."]}),"\n",(0,l.jsxs)(n.li,{children:["Use ",(0,l.jsx)(n.code,{children:"none"})," only for development or trusted bulk imports."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>t});var s=i(6540);const l={},r=s.createContext(l);function d(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);