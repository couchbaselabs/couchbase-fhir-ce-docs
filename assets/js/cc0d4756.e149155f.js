"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7251],{2465:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"API/patch","title":"PATCH Resource","description":"The PATCH operation allows you to modify specific fields of an existing resource without sending the entire document.","source":"@site/docs/API/patch.mdx","sourceDirName":"API","slug":"/API/patch","permalink":"/couchbase-fhir-ce-docs/docs/API/patch","draft":false,"unlisted":false,"editUrl":"https://github.com/couchbaselabs/couchbase-fhir-ce-docs/tree/master/docs/API/patch.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"PATCH Resource"},"sidebar":"tutorialSidebar","previous":{"title":"PUT - Update Resource","permalink":"/couchbase-fhir-ce-docs/docs/API/put-update"},"next":{"title":"Checkpoint after updates","permalink":"/couchbase-fhir-ce-docs/docs/API/check"}}');var r=t(4848),i=t(8453);const d=t.p+"assets/images/patch-4ff1650f334d7498013f813bae872809.png",a={sidebar_position:5,title:"PATCH Resource"},c="PATCH \u2014 Partial Update of a Resource",o={},l=[{value:"Endpoint",id:"endpoint",level:3},{value:"Example",id:"example",level:3},{value:"Server Response",id:"server-response",level:3},{value:"Behavior and Server Logic",id:"behavior-and-server-logic",level:2},{value:"metadata after patch",id:"metadata-after-patch",level:3},{value:"Common Patch Operations",id:"common-patch-operations",level:2},{value:"Data Storage &amp; Versioning",id:"data-storage--versioning",level:2},{value:"When to Use PATCH",id:"when-to-use-patch",level:2},{value:"Use PATCH when:",id:"use-patch-when",level:3},{value:"Use PUT when:",id:"use-put-when",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Summary",id:"summary",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"patch--partial-update-of-a-resource",children:"PATCH \u2014 Partial Update of a Resource"})}),"\n",(0,r.jsx)(n.p,{children:"The PATCH operation allows you to modify specific fields of an existing resource without sending the entire document.\nCouchbase FHIR CE implements FHIR\u2019s JSON Patch format, based on RFC 6902, with adaptations for FHIR resource structures."}),"\n",(0,r.jsx)(n.h3,{id:"endpoint",children:"Endpoint"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"PATCH /fhir/<bucket>/<resourceType>/<id>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,r.jsxs)(n.p,{children:["Update Patient/1234 to add a deceasedDateTime:\nPATCH ",(0,r.jsx)(n.a,{href:"http://localhost/fhir/acme/Patient/1234",children:"http://localhost/fhir/acme/Patient/1234"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[\n  { "op": "add", "path": "/deceasedDateTime", "value": "2022-07-22" }\n]\n'})}),"\n",(0,r.jsx)("img",{src:d,alt:"ImgPatch"}),"\n",(0,r.jsx)(n.h3,{id:"server-response",children:"Server Response"}),"\n",(0,r.jsx)(n.p,{children:"Response: 200 OK\nThe updated resource now includes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'"deceasedDateTime": "2022-07-22",\n"meta": {\n  "versionId": "3",\n  "lastUpdated": "2025-10-08T23:41:35.194+00:00",\n  "tag": [\n    {\n      "system": "http://couchbase.fhir.com/fhir/custom-tags",\n      "code": "updated-by",\n      "display": "user:anonymous"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"behavior-and-server-logic",children:"Behavior and Server Logic"}),"\n",(0,r.jsx)(n.p,{children:"PATCH is idempotent per operation list \u2014 applying the same patch twice yields the same result."}),"\n",(0,r.jsx)(n.p,{children:"Server wraps the operation in a transaction:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"Begin transaction\n  Load current Patient/1234\n  Apply each operation in order\n  Save the updated resource\n  Copy old version into Versions collection\n  Increment meta.versionId\n  Update meta.lastUpdated\n  Add updated-by tag\nCommit transaction\n"})}),"\n",(0,r.jsx)(n.p,{children:"Validation rules (Strict / Lenient / Disabled) are applied to the final resource after patching."}),"\n",(0,r.jsx)(n.h3,{id:"metadata-after-patch",children:"metadata after patch"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"versionId"})}),(0,r.jsx)(n.td,{children:"Incremented automatically"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"lastUpdated"})}),(0,r.jsx)(n.td,{children:"Timestamp of this update"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tag"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"updated-by"})," audit tag"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"profile"})}),(0,r.jsx)(n.td,{children:"Preserved from previous version"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"common-patch-operations",children:"Common Patch Operations"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"op"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Description"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Example Usage"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"add"})}),(0,r.jsx)(n.td,{children:"Adds a new value (or inserts into an array)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'{ "op": "add", "path": "/deceasedDateTime", "value": "2022-07-22" }'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"replace"})}),(0,r.jsx)(n.td,{children:"Replaces the value at the specified path"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'{ "op": "replace", "path": "/name/0/family", "value": "Johnson" }'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"remove"})}),(0,r.jsx)(n.td,{children:"Removes the value at the specified path"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'{ "op": "remove", "path": "/address/0" }'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"copy"})}),(0,r.jsx)(n.td,{children:"Copies a value from one path to another"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'{ "op": "copy", "from": "/name/0", "path": "/alias/0" }'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"move"})}),(0,r.jsx)(n.td,{children:"Moves a value from one path to another"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'{ "op": "move", "from": "/contact/0", "path": "/contact/1" }'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"test"})}),(0,r.jsx)(n.td,{children:"Asserts a value matches before continuing"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'{ "op": "test", "path": "/deceasedBoolean", "value": false }'})})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"data-storage--versioning",children:"Data Storage & Versioning"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Updated resource replaces the existing document in its collection (Resources.Patient)"}),"\n",(0,r.jsx)(n.li,{children:"Previous version stored in Resources.Versions"}),"\n",(0,r.jsx)(n.li,{children:"FTS index is refreshed with new content"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"when-to-use-patch",children:"When to Use PATCH"}),"\n",(0,r.jsx)(n.h3,{id:"use-patch-when",children:"Use PATCH when:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"You want to update specific fields only"}),"\n",(0,r.jsx)(n.li,{children:"You want to avoid sending or reconstructing the entire resource"}),"\n",(0,r.jsx)(n.li,{children:"You need atomic, targeted changes with full versioning"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"use-put-when",children:"Use PUT when:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"You\u2019re replacing the entire resource body"}),"\n",(0,r.jsx)(n.li,{children:"You want to reset the resource to a known state"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Always specify the full JSON Pointer path (e.g., /telecom/1/value)"}),"\n",(0,r.jsx)(n.li,{children:"Ensure your path exists for replace, or use add for new fields"}),"\n",(0,r.jsx)(n.li,{children:"Validate with Strict mode in production to catch invalid structures"}),"\n",(0,r.jsx)(n.li,{children:"Remember that arrays are zero-indexed"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"PATCH = partial update (RFC 6902)"}),"\n",(0,r.jsx)(n.li,{children:"Server ensures transactional safety and version history"}),"\n",(0,r.jsx)(n.li,{children:"versionId increments; old version archived"}),"\n",(0,r.jsx)(n.li,{children:"Fast, lightweight, and ideal for incremental updates"}),"\n",(0,r.jsx)(n.li,{children:"Fully FHIR R4-compliant"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>a});var s=t(6540);const r={},i=s.createContext(r);function d(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);