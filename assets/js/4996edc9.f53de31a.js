"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9488],{6675:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>x,frontMatter:()=>t,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"Overview/Architecture","title":"System Architecture","description":"Couchbase FHIR CE is a modular, containerized platform built for performance, scalability, and interoperability.","source":"@site/docs/Overview/Architecture.mdx","sourceDirName":"Overview","slug":"/Overview/Architecture","permalink":"/docs/Overview/Architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/couchbaselabs/couchbase-fhir-ce-docs/tree/master/docs/Overview/Architecture.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"System Architecture","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"FHIR + Couchbase","permalink":"/docs/Overview/Why Couchbase"},"next":{"title":"FHIR Resources on Couchbase","permalink":"/docs/Overview/FHIR Resources"}}');var i=r(4848),l=r(8453);const c=r.p+"assets/images/architecture-58aa075f72e7eb211cb6f3ec6325332e.png",t={title:"System Architecture",sidebar_position:2},d="System Architecture",a={},o=[{value:"High-Level Architecture",id:"high-level-architecture",level:2},{value:"Core building blocks:",id:"core-building-blocks",level:2},{value:"Component Breakdown",id:"component-breakdown",level:2},{value:"FHIR Server (<code>fhir-server</code>)",id:"fhir-server-fhir-server",level:3},{value:"FHIR Admin (<code>fhir-admin</code>)",id:"fhir-admin-fhir-admin",level:3},{value:"HAProxy (<code>haproxy</code>)",id:"haproxy-haproxy",level:3},{value:"Couchbase Server / Capella",id:"couchbase-server--capella",level:3},{value:"Data Flow",id:"data-flow",level:2},{value:"Deployment Model",id:"deployment-model",level:2},{value:"Architecture Principles",id:"architecture-principles",level:2},{value:"Operational Considerations",id:"operational-considerations",level:2},{value:"Summary",id:"summary",level:2},{value:"Next Steps",id:"next-steps",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"system-architecture",children:"System Architecture"})}),"\n",(0,i.jsxs)(n.p,{children:["Couchbase FHIR CE is a ",(0,i.jsx)(n.strong,{children:"modular, containerized platform"})," built for performance, scalability, and interoperability."]}),"\n",(0,i.jsxs)(n.p,{children:["It consists of ",(0,i.jsx)(n.strong,{children:"three core containers"}),", each with a dedicated role in the system:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"FHIR Server"})," \u2013 REST API, validation, persistence"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"FHIR Admin"})," \u2013 Frontend dashboard & management UI"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"HAProxy"})," \u2013 Smart load balancer, multi-tenant router, and metrics gateway"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Together, they form a complete FHIR platform that connects seamlessly to ",(0,i.jsx)(n.strong,{children:"Couchbase Server"})," or ",(0,i.jsx)(n.strong,{children:"Capella"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"high-level-architecture",children:"High-Level Architecture"}),"\n",(0,i.jsx)("img",{src:c,alt:"Architecture"}),"\n",(0,i.jsx)(n.h2,{id:"core-building-blocks",children:"Core building blocks:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["One or more ",(0,i.jsx)(n.strong,{children:"Couchbase clusters"})," (Self\u2011Managed or Capella)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"FHIR Server"})," container (Spring Boot + HAPI FHIR)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Admin UI"})," container (React + MUI)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"HAProxy"})," container (routing and metrics)"]}),"\n",(0,i.jsx)(n.li,{children:"Optional: synthetic data generators, monitoring/observability stack"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"component-breakdown",children:"Component Breakdown"}),"\n",(0,i.jsxs)(n.h3,{id:"fhir-server-fhir-server",children:["FHIR Server (",(0,i.jsx)(n.code,{children:"fhir-server"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"core of the platform"}),". Implements the FHIR RESTful API."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Built with ",(0,i.jsx)(n.strong,{children:"Spring Boot"})," and ",(0,i.jsx)(n.strong,{children:"HAPI FHIR"})]}),"\n",(0,i.jsxs)(n.li,{children:["Supports ",(0,i.jsx)(n.strong,{children:"FHIR R4"})," and ",(0,i.jsx)(n.strong,{children:"US Core Implementation Guide (IG)"})]}),"\n",(0,i.jsx)(n.li,{children:"Handles CRUD, search, validation, and transaction bundles"}),"\n",(0,i.jsxs)(n.li,{children:["Integrates with ",(0,i.jsx)(n.strong,{children:"Couchbase SDK"})," for data access"]}),"\n",(0,i.jsxs)(n.li,{children:["Supports:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"_include"}),", ",(0,i.jsx)(n.code,{children:"_revinclude"}),", ",(0,i.jsx)(n.code,{children:"$everything"})]}),"\n",(0,i.jsx)(n.li,{children:"Pagination and sorting"}),"\n",(0,i.jsx)(n.li,{children:"US Core validation via HAPI\u2019s validator + NPM packages"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Stores all resources as ",(0,i.jsx)(n.strong,{children:"native JSON documents"})," in Couchbase"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Multi-Tenancy:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Each ",(0,i.jsx)(n.strong,{children:"Couchbase bucket"})," represents one ",(0,i.jsx)(n.strong,{children:"tenant"})]}),"\n",(0,i.jsx)(n.li,{children:"Buckets are isolated by configuration and routing"}),"\n",(0,i.jsx)(n.li,{children:"Validation and search behaviors can differ per tenant"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Observability:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Metrics via ",(0,i.jsx)(n.strong,{children:"Micrometer + Spring Actuator"})]}),"\n",(0,i.jsxs)(n.li,{children:["Exposes ",(0,i.jsx)(n.code,{children:"/actuator/metrics"}),", ",(0,i.jsx)(n.code,{children:"/actuator/health"}),", ",(0,i.jsx)(n.code,{children:"/actuator/prometheus"})]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"fhir-admin-fhir-admin",children:["FHIR Admin (",(0,i.jsx)(n.code,{children:"fhir-admin"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.strong,{children:"React-based management dashboard"})," for administrators and developers."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Built with ",(0,i.jsx)(n.strong,{children:"React 19"}),", ",(0,i.jsx)(n.strong,{children:"MUI"}),", ",(0,i.jsx)(n.strong,{children:"Zustand"}),", ",(0,i.jsx)(n.strong,{children:"React Query"}),", and ",(0,i.jsx)(n.strong,{children:"Recharts"})]}),"\n",(0,i.jsxs)(n.li,{children:["Provides:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Real-time ",(0,i.jsx)(n.strong,{children:"cluster metrics"})," (CPU, memory, disk)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"FTS index"})," browser and status viewer"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Query dashboards"})," for testing and benchmarking"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validation logs"})," and ",(0,i.jsx)(n.strong,{children:"tenant configuration"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Communicates with backend APIs for metrics and management"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Features:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Light/Dark theme"}),"\n",(0,i.jsx)(n.li,{children:"Monaco JSON editor"}),"\n",(0,i.jsx)(n.li,{children:"Time-based dashboards with minute/hour/day sampling"}),"\n",(0,i.jsx)(n.li,{children:"HAProxy and FHIR metrics visualization"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"haproxy-haproxy",children:["HAProxy (",(0,i.jsx)(n.code,{children:"haproxy"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["A lightweight, high-performance ",(0,i.jsx)(n.strong,{children:"load balancer and router"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Routes incoming FHIR REST calls to the correct ",(0,i.jsx)(n.strong,{children:"tenant bucket"})]}),"\n",(0,i.jsxs)(n.li,{children:["Can route by ",(0,i.jsx)(n.strong,{children:"path prefix"})," (e.g., ",(0,i.jsx)(n.code,{children:"/fhir/{tenant}/..."}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Collects request-level metrics:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Active connections, response times, ops/sec"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Supports:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"SSL/TLS termination (optional)"}),"\n",(0,i.jsx)(n.li,{children:"Multi-node scaling"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Can be replaced by other gateways (NGINX, Kong) in advanced setups"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"couchbase-server--capella",children:"Couchbase Server / Capella"}),"\n",(0,i.jsxs)(n.p,{children:["The underlying ",(0,i.jsx)(n.strong,{children:"data platform"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Stores all ",(0,i.jsx)(n.strong,{children:"FHIR resources"})," as JSON documents"]}),"\n",(0,i.jsxs)(n.li,{children:["Organizes data by ",(0,i.jsx)(n.strong,{children:"bucket / scope / collection"})]}),"\n",(0,i.jsxs)(n.li,{children:["Uses ",(0,i.jsx)(n.strong,{children:"Full Text Search (FTS)"})," indexes for query"]}),"\n",(0,i.jsxs)(n.li,{children:["Provides ",(0,i.jsx)(n.strong,{children:"KV, N1QL, FTS APIs"})]}),"\n",(0,i.jsxs)(n.li,{children:["Offers ",(0,i.jsx)(n.strong,{children:"horizontal scalability"})," and ",(0,i.jsx)(n.strong,{children:"high availability"})]}),"\n",(0,i.jsx)(n.li,{children:"Works on-prem (self-managed) or cloud (Capella)"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"data-flow",children:"Data Flow"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"[Client / App]\n   \u2193\n  [HAProxy]\n   \u2193\n [FHIR Server] \u21c6 [Couchbase Cluster]\n   \u2191\n [FHIR Admin Dashboard]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Request lifecycle (example: ",(0,i.jsx)(n.code,{children:"GET /fhir/acme/Patient?name=John"}),"):"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["HAProxy routes the request to FHIR Server with tenant context ",(0,i.jsx)(n.code,{children:"bucket=acme"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["FHIR Server parses search params (HAPI FHIR) and builds an ",(0,i.jsx)(n.strong,{children:"FTS query"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Couchbase ",(0,i.jsx)(n.strong,{children:"FTS"})," returns matching document IDs."]}),"\n",(0,i.jsxs)(n.li,{children:["Couchbase ",(0,i.jsx)(n.strong,{children:"KV"})," fetches full JSON resources by ID (batched)."]}),"\n",(0,i.jsxs)(n.li,{children:["FHIR Server assembles and returns a ",(0,i.jsx)(n.strong,{children:"FHIR Bundle"})," response."]}),"\n",(0,i.jsx)(n.li,{children:"Admin UI polls metrics/logs from FHIR Server and HAProxy for observability."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Notes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"FTS handles query semantics; KV guarantees low\u2011latency retrieval."}),"\n",(0,i.jsx)(n.li,{children:"Pagination can reuse cached ID sets to avoid repeated FTS cost."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"deployment-model",children:"Deployment Model"}),"\n",(0,i.jsx)(n.p,{children:"Couchbase FHIR CE is fully containerized and can run anywhere:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Developer machines via ",(0,i.jsx)(n.code,{children:"docker-compose"})]}),"\n",(0,i.jsx)(n.li,{children:"Cloud VMs (for example, AWS EC2) connecting to Couchbase Server"}),"\n",(0,i.jsx)(n.li,{children:"Capella (managed Couchbase) with FHIR services deployed in your environment"}),"\n",(0,i.jsx)(n.li,{children:"On\u2011prem Kubernetes or VM clusters"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Typical ",(0,i.jsx)(n.code,{children:"docker-compose"})," stack includes:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"fhir-server"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"fhir-admin"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"haproxy"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Optional add\u2011ons: Inferno validator, Redis (caching), Prometheus/Grafana (monitoring)."}),"\n",(0,i.jsx)(n.h2,{id:"architecture-principles",children:"Architecture Principles"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Principle"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"JSON\u2011native"}),(0,i.jsx)(n.td,{children:"Store FHIR resources as\u2011is; no transformation layer"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Composable"}),(0,i.jsx)(n.td,{children:"Each service can be replaced independently"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Observable"}),(0,i.jsx)(n.td,{children:"Metrics everywhere: server, HAProxy, Couchbase"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Scalable"}),(0,i.jsx)(n.td,{children:"Horizontal scale via buckets, nodes, partitions"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Multi\u2011tenant"}),(0,i.jsx)(n.td,{children:"Buckets isolate tenants; per\u2011tenant configuration"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Secure"}),(0,i.jsx)(n.td,{children:"TLS\u2011ready; authentication/authorization pluggable"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"operational-considerations",children:"Operational Considerations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Scalability: Scale out by adding Couchbase nodes, partitioning FTS indexes, and horizontally scaling ",(0,i.jsx)(n.code,{children:"fhir-server"})," pods/containers."]}),"\n",(0,i.jsx)(n.li,{children:"Security: Enable TLS end\u2011to\u2011end; restrict ingress via HAProxy; use least\u2011privilege DB credentials; isolate tenants per bucket."}),"\n",(0,i.jsx)(n.li,{children:"Observability: Expose Prometheus metrics from FHIR Server and HAProxy; visualize with Grafana; enable structured logs."}),"\n",(0,i.jsxs)(n.li,{children:["Resilience: Run multiple ",(0,i.jsx)(n.code,{children:"fhir-server"})," instances behind HAProxy; configure health checks; set sensible timeouts and retries."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.p,{children:"The modular design of Couchbase FHIR CE lets you:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Deploy quickly with containers"}),"\n",(0,i.jsx)(n.li,{children:"Scale predictably across tenants and data volume"}),"\n",(0,i.jsx)(n.li,{children:"Operate with rich metrics and clear separation of concerns"}),"\n",(0,i.jsx)(n.li,{children:"Achieve low\u2011latency, standards\u2011compliant FHIR operations via KV + FTS"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Understand how resources map to collections: ",(0,i.jsx)(n.a,{href:"/docs/Overview/FHIR%20Resources",children:"FHIR Resources on Couchbase"})]}),"\n",(0,i.jsxs)(n.li,{children:["Learn how search is implemented: ",(0,i.jsx)(n.a,{href:"/docs/Overview/FTS%20Index",children:"Indexing Strategy (FTS)"})]}),"\n"]})]})}function x(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>t});var s=r(6540);const i={},l=s.createContext(i);function c(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);